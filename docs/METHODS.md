# MAPI Methods

MAPILib provides two types of methods for most operations:

1. Methods that return an `MAPIResult`
2. Methods that return values directly for convenience

## MAPIResult Methods

An `MAPIResult` is an enum of different errors that may occur during a call. Methods that return an `MAPIResult` are useful for debugging or testing.

```C#
public enum MAPIResult
{
    OK,
    CONNECT_FAILED,
    GET_DATASOCKET_FAILED,
    CONNECT_DATASOCKET_FAILED,
    SEND_COMMAND_FAILED,
    WRONG_RESPONSE_CODE,
    GET_RESPONSE_BUFFER_FAILED,
    DATASOCKET_SEND_FAILED,
    PARSE_PID_FAILED,
    PARSE_SYSCALL_FAILED,
    PARSE_TEMPERATURE_FAILED
}
```

These are the MAPILib methods that return an `MAPIResult`.

```C#
MAPIResult Connect(string host, int port = 7887)
MAPIResult GetCurrentProcessId(out uint? processId)
MAPIResult GetProcessIds(out uint[]? processIds)
MAPIResult GetMemory(uint processId, uint address, uint size, out byte[]? buffer)
MAPIResult SetMemory(uint processId, uint address, byte[] buffer)
MAPIResult Syscall(uint number, object[] args, out ulong? result)
MAPIResult GetFirmwareVersion(out string? version)
MAPIResult GetTemperature(out int? cpu, out int? rsx)
```

## Convenience Methods

Convenience methods are useful if you're only concerned with success / failure. If a returned value is null or default, it means that the call failed.

```C#
uint? GetCurrentProcessId()
uint[]? GetProcessIds()
byte[]? GetMemory(uint processId, uint address, uint size)
ulong? Syscall(uint number, object[] args)
string? GetFirmwareVersion()
(int? cpu, int? rsx) GetTemperature()
```

Finally, while it's not quite a convenience method, there is also the disconnect method.

```C#
void Disconnect();
```

## Method Documentation

This section is currently written by hand and will be autogenerated in the near future.

* [MAPIResult Connect](#mapiresult-connectstring-host-int-port)
* [void Disconnect](#void-disconnect)
* [MAPIResult GetCurrentProcessId](#mapiresult-getcurrentprocessidout-uint-processid)
* [uint? GetCurrentProcessId](#uint-getcurrentprocessid)
* [MAPIResult GetProcessIds](#mapiresult-getprocessidsout-uint-processids)
* [uint[]? GetProcessIds](#uint-getprocessids)
* [MAPIResult GetMemory](#mapiresult-getmemoryuint-processid-uint-address-uint-size-out-byte-buffer)
* [byte[]? GetMemory](#byte-getmemoryuint-processid-uint-address-uint-size)
* [MAPIResult SetMemory](#mapiresult-setmemoryuint-processid-uint-address-byte-buffer)

### MAPIResult Connect(string host, int port)

Connects to a console's MAPI server.

* Parameters
    * host (string): the IP address of the console you'd like to connect
    * port (int): the port of the console's MAPI server, 7887 by default
* Returns:
    MAPIResult: result of the MAPI call

### void Disconnect()

Disconnects from the currently connected MAPI server.

### MAPIResult GetCurrentProcessId(out uint? processId)

* Parameters
    * processId (out uint?): the ID of the currently running process or null upon failure
* Returns
    * MAPIResult: result of the MAPI call

### uint? GetCurrentProcessId()

Gets the ID of the currently running process.

* Returns
    * uint?: the ID of the currently running process or null upon failure

### MAPIResult GetProcessIds(out uint[]? processIds)

Gets the IDs of the currently running processes.

* Parameters
    * processIds (out uint[]?): an array of the console's currently running process IDs or null upon failure
* Returns
    * MAPIResult: result of the MAPI call

### uint[]? GetProcessIds()

Gets the IDs of the currently running processes.

* Returns
    * uint[]?: an array of the console's currently running process IDs or null upon failure

### MAPIResult GetMemory(uint processId, uint address, uint size, out byte[]? buffer)

Gets an array of bytes from a process's memory.

* Parameters
    * processId (uint): the ID of the process to read from
    * address (uint): the address in the process to read from
    * size (uint): the number of bytes to read from the process
    * buffer (out byte[]?) : an array of data read from the process or null upon failure
* Returns
    * MAPIResult: result of the MAPI call

### byte[]? GetMemory(uint processId, uint address, uint size)

Gets an array of bytes from a process's memory.

* Parameters
    * processId (uint): the ID of the process to read from
    * address (uint): the address in the process to read from
    * size (uint): the number of bytes to read from the process
* Returns
    * byte[]?: an array of data read from the process or null upon failure

### MAPIResult SetMemory(uint processId, uint address, byte[] buffer)

Sets an array of bytes in a processes's memory.

* Parameters
    * processId (uint): the ID of the process to write to
    * address (uint): the address in the process to write to
    * buffer (byte[]): the array of data to write to the process
* Returns
    * MAPIResult: result of the MAPI call

## Usage Examples

If you'd like to see some usage examples of these methods, you can find them here:

[Usage Examples](/docs/EXAMPLES.md)